# Xray ç®¡ç†å·¥å…· - å¿«é€Ÿå‚è€ƒ

## ðŸš€ å¿«é€Ÿå¼€å§‹

```bash
# 1. æ·»åŠ æ‰§è¡Œæƒé™
chmod +x xray-*.sh

# 2. æ·»åŠ èŠ‚ç‚¹
./xray-proxy-manager.sh node-add "vless://..." "èŠ‚ç‚¹å"

# 3. å¯åŠ¨æœåŠ¡
sudo ./xray-proxy-manager.sh start

# 4. æµ‹è¯•è¿žæŽ¥
./xray-proxy-manager.sh test
```

---

## ðŸ“‹ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨

### æœåŠ¡ç®¡ç†

| å‘½ä»¤ | è¯´æ˜Ž |
|------|------|
| `sudo ./xray-proxy-manager.sh start` | å¯åŠ¨æœåŠ¡ï¼ˆå«èŠ‚ç‚¹é€‰æ‹©ï¼‰ |
| `sudo ./xray-proxy-manager.sh stop` | åœæ­¢æœåŠ¡å¹¶æ¸…ç†ä»£ç† |
| `sudo ./xray-proxy-manager.sh restart` | é‡å¯æœåŠ¡ |
| `./xray-proxy-manager.sh status` | æŸ¥çœ‹çŠ¶æ€ |
| `./xray-proxy-manager.sh test` | æµ‹è¯•ä»£ç† |
| `./xray-proxy-manager.sh logs` | æŸ¥çœ‹æ—¥å¿— |

### èŠ‚ç‚¹ç®¡ç†

| å‘½ä»¤ | è¯´æ˜Ž |
|------|------|
| `./xray-proxy-manager.sh node-add "é“¾æŽ¥" "åç§°"` | æ·»åŠ èŠ‚ç‚¹ |
| `./xray-proxy-manager.sh node-list` | åˆ—å‡ºæ‰€æœ‰èŠ‚ç‚¹ |
| `./xray-proxy-manager.sh node-select` | é€‰æ‹©èŠ‚ç‚¹ï¼ˆäº¤äº’å¼ï¼‰ |
| `./xray-proxy-manager.sh node-switch èŠ‚ç‚¹å` | åˆ‡æ¢åˆ°æŒ‡å®šèŠ‚ç‚¹ |
| `./xray-proxy-manager.sh node-current` | æŸ¥çœ‹å½“å‰èŠ‚ç‚¹ |
| `./xray-proxy-manager.sh node-delete èŠ‚ç‚¹å` | åˆ é™¤èŠ‚ç‚¹ |

### ä»£ç†æ¨¡å¼

| å‘½ä»¤ | è¯´æ˜Ž |
|------|------|
| `sudo ./xray-proxy-manager.sh proxy-on` | å¯ç”¨ç³»ç»Ÿä»£ç† |
| `sudo ./xray-proxy-manager.sh proxy-off` | ç¦ç”¨ç³»ç»Ÿä»£ç† |
| `sudo ./xray-proxy-manager.sh tproxy-on` | å¯ç”¨é€æ˜Žä»£ç† |
| `sudo ./xray-proxy-manager.sh tproxy-off` | ç¦ç”¨é€æ˜Žä»£ç† |
| `./xray-proxy-manager.sh proxy-status` | æŸ¥çœ‹ä»£ç†çŠ¶æ€ |

### è·¯ç”±æ¨¡å¼

| å‘½ä»¤ | è¯´æ˜Ž |
|------|------|
| `sudo ./xray-proxy-manager.sh route-mode bypass-cn` | ç»•è¿‡å¤§é™†ï¼ˆæŽ¨èï¼‰ |
| `sudo ./xray-proxy-manager.sh route-mode global` | å…¨å±€ä»£ç† |
| `sudo ./xray-proxy-manager.sh route-mode direct` | å…¨éƒ¨ç›´è¿ž |
| `./xray-proxy-manager.sh route-status` | æŸ¥çœ‹è·¯ç”±æ¨¡å¼ |

---

## ðŸŽ¯ ä¸‰ç§è·¯ç”±æ¨¡å¼

| æ¨¡å¼ | å›½å†…ç½‘ç«™ | å›½å¤–ç½‘ç«™ | é€‚ç”¨åœºæ™¯ |
|------|---------|---------|---------|
| **bypass-cn** | ç›´è¿ž | èµ°ä»£ç† | æ—¥å¸¸ä½¿ç”¨ï¼ˆæŽ¨èï¼‰ |
| **global** | èµ°ä»£ç† | èµ°ä»£ç† | å®Œå…¨éšè— IP |
| **direct** | ç›´è¿ž | ç›´è¿ž | ä¸´æ—¶ç¦ç”¨ä»£ç† |

---

## ðŸ”§ ä¸¤ç§ä»£ç†æ¨¡å¼å¯¹æ¯”

| ç‰¹æ€§ | ç³»ç»Ÿä»£ç† | é€æ˜Žä»£ç† |
|------|---------|---------|
| å¯¹å·²è¿è¡Œç¨‹åºç”Ÿæ•ˆ | âŒ å¦ | âœ… æ˜¯ |
| éœ€è¦ç¨‹åºæ”¯æŒ | âœ… éœ€è¦ | âŒ ä¸éœ€è¦ |
| å¯æŽ’é™¤ç‰¹å®šåº”ç”¨ | âŒ éš¾ | âœ… æ˜“ |
| é…ç½®å¤æ‚åº¦ | ä½Ž | ä¸­ |
| é€‚ç”¨åœºæ™¯ | æ¡Œé¢çŽ¯å¢ƒ | æœåŠ¡å™¨ |

---

## ðŸ“ ä½¿ç”¨ä½ çš„ VLESS é“¾æŽ¥

```bash
# ä½ çš„é“¾æŽ¥
LINK="vless://e6fde711-f524-4c34-8ffc-63806e2fb1f2@190.93.246.238:443?encryption=...&flow=xtls-rprx-vision&security=tls&sni=tun.silverisky.com&fp=chrome&alpn=h2%2Ch3&insecure=1&type=xhttp&host=tun.silverisky.com&path=%2Fsu57&mode=auto#CDN-eva-æŠ—é‡å­"

# æ·»åŠ èŠ‚ç‚¹
./xray-proxy-manager.sh node-add "$LINK"

# å¯åŠ¨
sudo ./xray-proxy-manager.sh start

# æµ‹è¯•
./xray-proxy-manager.sh test
```

---

## ðŸ› ï¸ é€æ˜Žä»£ç†æŽ’é™¤è§„åˆ™

### é…ç½®æ–‡ä»¶

```bash
sudo vi /usr/local/etc/xray/tproxy-bypass.conf
```

### å¸¸ç”¨æŽ’é™¤è§„åˆ™

```bash
# æŒ‰ç”¨æˆ·æŽ’é™¤
BYPASS_USERS=(
    "mysql"
    "nginx"
    "noproxy"
)

# æŒ‰ç«¯å£æŽ’é™¤
BYPASS_PORTS=(
    22        # SSH
    3306      # MySQL
    5432      # PostgreSQL
    6379      # Redis
)

# æŒ‰ IP æŽ’é™¤
BYPASS_IPS=(
    "192.168.1.0/24"    # å†…ç½‘
    "10.0.0.0/8"        # å†…ç½‘
)
```

### åº”ç”¨æŽ’é™¤è§„åˆ™

```bash
# é‡æ–°å¯ç”¨é€æ˜Žä»£ç†
sudo ./xray-proxy-manager.sh tproxy-off
sudo ./xray-proxy-manager.sh tproxy-on
```

---

## ðŸ” æ•…éšœæŽ’æŸ¥

### æœåŠ¡å¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹æ—¥å¿—
./xray-proxy-manager.sh logs

# æµ‹è¯•é…ç½®
xray run -test -config /usr/local/etc/xray/config.json

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
systemctl status xray.service
```

### ä»£ç†æ— æ³•è¿žæŽ¥

```bash
# æµ‹è¯•ä»£ç†
./xray-proxy-manager.sh test

# æŸ¥çœ‹å½“å‰èŠ‚ç‚¹
./xray-proxy-manager.sh node-current

# åˆ‡æ¢èŠ‚ç‚¹
sudo ./xray-proxy-manager.sh node-select
```

### é€æ˜Žä»£ç†ä¸å·¥ä½œ

```bash
# æ£€æŸ¥ iptables è§„åˆ™
sudo iptables -t mangle -L XRAY -n -v

# é‡æ–°å¯ç”¨
sudo ./xray-proxy-manager.sh tproxy-off
sudo ./xray-proxy-manager.sh tproxy-on
```

### ç³»ç»Ÿä»£ç†ä¸ç”Ÿæ•ˆ

```bash
# å½“å‰ç»ˆç«¯ç«‹å³ä½¿ç”¨
source /etc/profile.d/xray-proxy.sh

# æˆ–é‡å¯ç¨‹åº
killall my_program
my_program &

# æˆ–ä½¿ç”¨é€æ˜Žä»£ç†
sudo ./xray-proxy-manager.sh tproxy-on
```

---

## ðŸ“‚ é‡è¦æ–‡ä»¶ä½ç½®

| æ–‡ä»¶ | ä½ç½® |
|------|------|
| å½“å‰é…ç½® | `/usr/local/etc/xray/config.json` |
| èŠ‚ç‚¹ç›®å½• | `/usr/local/etc/xray/nodes/` |
| æŽ’é™¤è§„åˆ™ | `/usr/local/etc/xray/tproxy-bypass.conf` |
| ç³»ç»Ÿä»£ç† | `/etc/profile.d/xray-proxy.sh` |
| æœåŠ¡æ–‡ä»¶ | `/etc/systemd/system/xray.service` |

---

## ðŸ” ç«¯å£è¯´æ˜Ž

| ç«¯å£ | åè®® | ç”¨é€” |
|------|------|------|
| 10808 | mixed | SOCKS5 + HTTP ä»£ç† |
| 12345 | dokodemo-door | é€æ˜Žä»£ç† |

---

## ðŸ’¡ å®žç”¨æŠ€å·§

### åˆ›å»ºå¿«æ·å‘½ä»¤

```bash
# æ·»åŠ åˆ° ~/.bashrc
alias xray-start='sudo /path/to/xray-proxy-manager.sh start'
alias xray-stop='sudo /path/to/xray-proxy-manager.sh stop'
alias xray-test='/path/to/xray-proxy-manager.sh test'
alias xray-pac='sudo /path/to/xray-proxy-manager.sh route-mode bypass-cn'
alias xray-global='sudo /path/to/xray-proxy-manager.sh route-mode global'

# é‡æ–°åŠ è½½
source ~/.bashrc
```

### æŸ¥çœ‹å¤–éƒ¨ IP

```bash
# ä½¿ç”¨ä»£ç†æŸ¥çœ‹
curl --socks5 127.0.0.1:10808 https://api.ipify.org

# æˆ–ä½¿ç”¨æµ‹è¯•å‘½ä»¤
./xray-proxy-manager.sh test
```

### æ‰¹é‡æ·»åŠ èŠ‚ç‚¹

```bash
# åˆ›å»ºèŠ‚ç‚¹åˆ—è¡¨
cat > nodes.txt <<EOF
vless://...#èŠ‚ç‚¹1
vless://...#èŠ‚ç‚¹2
vless://...#èŠ‚ç‚¹3
EOF

# æ‰¹é‡æ·»åŠ 
while read link; do
    ./xray-proxy-manager.sh node-add "$link"
done < nodes.txt
```

---

## ðŸ“ž èŽ·å–å¸®åŠ©

```bash
# ä¸»è„šæœ¬å¸®åŠ©
./xray-proxy-manager.sh help

# èŠ‚ç‚¹ç®¡ç†å¸®åŠ©
./xray-node-manager.sh help

# è·¯ç”±æ¨¡å¼å¸®åŠ©
./xray-routing-mode.sh help
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç³»ç»Ÿä»£ç†åªå¯¹æ–°å¯åŠ¨çš„ç¨‹åºç”Ÿæ•ˆ**ï¼Œå·²è¿è¡Œçš„ç¨‹åºéœ€è¦é‡å¯
2. **é€æ˜Žä»£ç†å¯¹æ‰€æœ‰ç¨‹åºç”Ÿæ•ˆ**ï¼ŒåŒ…æ‹¬å·²è¿è¡Œçš„ç¨‹åº
3. **åˆ‡æ¢è·¯ç”±æ¨¡å¼éœ€è¦ jq**ï¼š`sudo apt install jq`
4. **ä¿®æ”¹æŽ’é™¤è§„åˆ™åŽéœ€è¦é‡æ–°å¯ç”¨é€æ˜Žä»£ç†**
5. **å¤§å¤šæ•°æ“ä½œéœ€è¦ root æƒé™**ï¼Œä½¿ç”¨ `sudo`

---

## ðŸŽ¯ æŽ¨èé…ç½®

### æ— æ¡Œé¢æœåŠ¡å™¨

```bash
# 1. æ·»åŠ èŠ‚ç‚¹
./xray-proxy-manager.sh node-add "vless://..." "ä¸»èŠ‚ç‚¹"

# 2. å¯åŠ¨å¹¶é€‰æ‹©é€æ˜Žä»£ç†
sudo ./xray-proxy-manager.sh start
# é€‰æ‹©ï¼šé€æ˜Žä»£ç†

# 3. è®¾ç½®ç»•è¿‡å¤§é™†
sudo ./xray-proxy-manager.sh route-mode bypass-cn

# 4. é…ç½®æŽ’é™¤è§„åˆ™ï¼ˆå¯é€‰ï¼‰
sudo vi /usr/local/etc/xray/tproxy-bypass.conf
```

### æ¡Œé¢çŽ¯å¢ƒ

```bash
# 1. æ·»åŠ èŠ‚ç‚¹
./xray-proxy-manager.sh node-add "vless://..." "ä¸»èŠ‚ç‚¹"

# 2. å¯åŠ¨å¹¶é€‰æ‹©ç³»ç»Ÿä»£ç†
sudo ./xray-proxy-manager.sh start
# é€‰æ‹©ï¼šç³»ç»Ÿä»£ç†

# 3. è®¾ç½®ç»•è¿‡å¤§é™†
sudo ./xray-proxy-manager.sh route-mode bypass-cn

# 4. å½“å‰ç»ˆç«¯ä½¿ç”¨ä»£ç†
source /etc/profile.d/xray-proxy.sh
```

---

**å¿«é€Ÿå‚è€ƒå¡ç‰‡ v2.0** | å®Œæ•´æ–‡æ¡£è¯·æŸ¥çœ‹ï¼š`ä¸­æ–‡ä½¿ç”¨æ‰‹å†Œ.md`
